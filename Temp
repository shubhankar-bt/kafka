<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <parent>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-parent</artifactId>
        <version>3.3.0</version>
        <relativePath/> <!-- lookup parent from repository -->
    </parent>
    <groupId>com.fincore</groupId>
    <artifactId>HelpService</artifactId>
    <version>0.0.1-SNAPSHOT</version>
    <name>HelpService</name>
    <description>HelpService</description>
    <url/>
    <licenses>
        <license/>
    </licenses>
    <developers>
        <developer/>
    </developers>
    <scm>
        <connection/>
        <developerConnection/>
        <tag/>
        <url/>
    </scm>
    <properties>
        <java.version>21</java.version>
    </properties>

    <dependencies>
        <!-- Core Web -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>

        <!-- Persistence -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-data-jpa</artifactId>
        </dependency>
        <dependency>
            <groupId>com.oracle.database.jdbc</groupId>
            <artifactId>ojdbc11</artifactId>
            <scope>runtime</scope>
        </dependency>

        <!-- Caching (Redis) -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-data-redis</artifactId>
        </dependency>

        <!-- Tools -->
        <dependency>
            <groupId>org.projectlombok</groupId>
            <artifactId>lombok</artifactId>
            <optional>true</optional>
        </dependency>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-validation</artifactId>
        </dependency>

        <dependency>
            <groupId>com.fincore</groupId>
            <artifactId>common-utilities</artifactId>
            <version>0.0.1-SNAPSHOT</version>
        </dependency>

    </dependencies>


    <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <configuration>
                    <annotationProcessorPaths>
                        <path>
                            <groupId>org.springframework.boot</groupId>
                            <artifactId>spring-boot-configuration-processor</artifactId>
                        </path>
                        <path>
                            <groupId>org.projectlombok</groupId>
                            <artifactId>lombok</artifactId>
                        </path>
                    </annotationProcessorPaths>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
                <configuration>
                    <excludes>
                        <exclude>
                            <groupId>org.projectlombok</groupId>
                            <artifactId>lombok</artifactId>
                        </exclude>
                    </excludes>
                </configuration>
            </plugin>
        </plugins>
    </build>

</project>





















# ==============================================================
# FIN CORE - HELP SERVICE CONFIGURATION
# ==============================================================
spring.application.name=HelpService
server.port=9099

# --- ORACLE DATABASE ---
# Ensure these match your DB credentials
spring.datasource.url=jdbc:oracle:thin:@//10.1.1.1:1521/FINCOREDB
spring.datasource.username=FIN_HELP_USER
spring.datasource.password=YourSecurePassword
spring.datasource.driver-class-name=oracle.jdbc.OracleDriver

# --- JPA / HIBERNATE ---
spring.jpa.database-platform=org.hibernate.dialect.OracleDialect
spring.jpa.show-sql=false
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.open-in-view=false

# --- REDIS CACHE ---
spring.data.redis.host=10.0.17.242
spring.data.redis.port=6379
spring.cache.type=redis
# Cache TTL: 1 Hour (Refresh help content periodically)
spring.cache.redis.time-to-live=3600000

# --- LOGGING ---
logging.level.com.fincore.HelpService=INFO
logging.level.org.springframework.web=WARN
















package com.fincore.helpservice.config;

import com.fincore.commonutilities.config.CommonSecurityConfig;
import com.fincore.commonutilities.config.RedisConfig;
import com.fincore.commonutilities.jwt.JwtUtil;
import com.fincore.commonutilities.security.ContextRbacFilter;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Import;
import org.springframework.data.redis.core.StringRedisTemplate;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.http.SessionCreationPolicy;
import org.springframework.security.web.SecurityFilterChain;
import org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter;

/**
 * Common Security Configuration.
 * * Aligned with the "Distributed Gateway" architecture.
 * It uses the ContextRbacFilter from Common Utilities to enforce:
 * 1. Token Validity
 * 2. Single Session (Redis check)
 * 3. RBAC Permissions
 */
@Configuration
@EnableWebSecurity
@Import({RedisConfig.class, JwtUtil.class, CommonSecurityConfig.class}) // Import logic from JAR
public class SecurityConfig {

    @Autowired
    private StringRedisTemplate redisTemplate;

    @Autowired
    private JwtUtil jwtUtil;

    @Autowired
    private CommonSecurityConfig commonSecurityConfig; // Wire in the CORS config

    @Bean
    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        http
                // 1. Disable CSRF (Stateless API)
                .csrf(csrf -> csrf.disable())

                // 2. Apply Centralized CORS Policy
                .cors(cors -> cors.configurationSource(commonSecurityConfig.corsConfigurationSource()))

                // 3. Stateless Session (No JSESSIONID)
                .sessionManagement(s -> s.sessionCreationPolicy(SessionCreationPolicy.STATELESS))

                // 4. Authorization Rules
                .authorizeHttpRequests(authz -> authz
                        // Public Endpoints
                        .requestMatchers("/actuator/**", "/api/auth/**", "/error").permitAll()
                        // All other endpoints require Authentication (and RBAC filter check)
                        .anyRequest().authenticated()
                )

                // 5. Add the "Distributed Gateway" Filter
                .addFilterBefore(new ContextRbacFilter(redisTemplate, jwtUtil), UsernamePasswordAuthenticationFilter.class);

        return http.build();
    }
}



















package com.fincore.HelpService.entity;

import jakarta.persistence.*;
import lombok.Data;
import org.hibernate.annotations.CreationTimestamp;
import org.hibernate.annotations.UpdateTimestamp;

import java.io.Serializable;
import java.time.LocalDateTime;
import java.util.UUID;

/**
 * ENTITY: HELP_SCREEN_MASTER
 */
@Data
@Entity
@Table(name = "HELP_SCREEN_MASTER")
public class HelpScreenEntity implements Serializable {
    
    @Id
    @Column(name = "SCREEN_NAME", length = 100)
    private String screenName;

    @Column(name = "SCREEN_LABEL", length = 100)
    private String screenLabel;

    @Column(name = "IS_ACTIVE", length = 1)
    private String isActive;

    @CreationTimestamp
    @Column(name = "CREATED_AT", updatable = false)
    private LocalDateTime createdAt;
}

/**
 * ENTITY: HELP_QUESTION_MASTER
 * Includes ID generation logic.
 */
@Data
@Entity
@Table(name = "HELP_QUESTION_MASTER")
public class HelpQuestionEntity implements Serializable {

    @Id
    @Column(name = "QUESTION_ID", length = 50)
    private String questionId;

    @Column(name = "SCREEN_NAME", length = 100, nullable = false)
    private String screenName;

    @Column(name = "QUESTION_TEXT", length = 500, nullable = false)
    private String questionText;

    // Use @Lob for Oracle CLOB types
    @Lob
    @Column(name = "ANSWER_CONTENT")
    private String answerContent;

    @Column(name = "ACTION_LINK")
    private String actionLink;

    @Column(name = "ACTION_LABEL")
    private String actionLabel;

    @Column(name = "REQUIRED_ACTION", length = 50)
    private String requiredAction; 

    @Column(name = "KEYWORDS", length = 1000)
    private String keywords; 

    @Column(name = "DISPLAY_ORDER")
    private Integer displayOrder;

    @Column(name = "IS_ACTIVE", length = 1)
    private String isActive;

    @CreationTimestamp
    @Column(name = "CREATED_AT", updatable = false)
    private LocalDateTime createdAt;

    @UpdateTimestamp
    @Column(name = "UPDATED_AT")
    private LocalDateTime updatedAt;

    // Auto-generate UUID if missing
    @PrePersist
    public void prePersist() {
        if (this.questionId == null || this.questionId.isEmpty()) {
            this.questionId = UUID.randomUUID().toString().replace("-", "").substring(0, 32);
        }
    }
}

/**
 * ENTITY: HELP_FAQ_MASTER
 */
@Data
@Entity
@Table(name = "HELP_FAQ_MASTER")
public class HelpFaqEntity implements Serializable {

    @Id
    @Column(name = "FAQ_ID", length = 50)
    private String faqId;

    @Column(name = "QUESTION_TEXT", length = 500)
    private String questionText;

    @Lob
    @Column(name = "ANSWER_CONTENT")
    private String answerContent;

    @Column(name = "DISPLAY_ORDER")
    private Integer displayOrder;

    @Column(name = "IS_ACTIVE")
    private String isActive;

    @PrePersist
    public void prePersist() {
        if (this.faqId == null || this.faqId.isEmpty()) {
            this.faqId = UUID.randomUUID().toString();
        }
    }
}





















package com.fincore.HelpService.repository;

import com.fincore.HelpService.entity.HelpFaqEntity;
import com.fincore.HelpService.entity.HelpQuestionEntity;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.stereotype.Repository;

import java.util.List;

@Repository
public interface HelpQuestionRepository extends JpaRepository<HelpQuestionEntity, String> {

    // For Context Mode: Select Module
    List<HelpQuestionEntity> findByScreenNameAndIsActiveOrderByDisplayOrderAsc(String screenName, String isActive);

    // For Search Mode: Fetch All Active
    List<HelpQuestionEntity> findByIsActive(String isActive);
}

@Repository
public interface HelpFaqRepository extends JpaRepository<HelpFaqEntity, String> {
    
    // Global FAQs
    List<HelpFaqEntity> findByIsActiveOrderByDisplayOrderAsc(String isActive);
}


























package com.fincore.helpservice.dto;

import lombok.Builder;
import lombok.Data;
import java.io.Serializable;

/**
 * Individual Item (Question/Answer)
 */
@Data
@Builder
public class HelpItemDTO implements Serializable {

    private String id;
    private String text;       // The Question
    private String answer;     // The Answer (HTML/Text)
    private String actionLink; // Deep Link
    private String actionLabel;// Button Text
    private String type;       // QUESTION, FAQ, SEARCH_RESULT
    private double searchScore; // Internal use (optional to expose)

}







package com.fincore.helpservice.dto;

import jakarta.validation.constraints.NotNull;
import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;
import java.util.List;

/**
 * Request Payload for Contextual Fetch or Search
 */
@Data
@NoArgsConstructor
@AllArgsConstructor
public class HelpRequestDTO {

    // Mode A: Context Fetch (Select from dropdown)
    private String screenName;

    // Mode B: Free Text Search
    private String searchQuery;

    // RBAC: User's Allowed Actions (from Login Token)
    // e.g., ["VIEW", "CREATE", "APPROVE"]
    @NotNull(message = "User actions cannot be null")
    private List<String> userActions;

    private boolean fetchFaqs;
}









package com.fincore.helpservice.dto;

import com.fasterxml.jackson.annotation.JsonInclude;
import lombok.Builder;
import lombok.Data;
import java.util.List;

/**
 * Standard Response
 */
@Data
@Builder
@JsonInclude(JsonInclude.Include.NON_NULL)
public class HelpResponseDTO {

    private String context; // e.g. "CGL Management" or "Search Results"
    private List<HelpItemDTO> results;
    private List<HelpItemDTO> faqs;
}
















package com.fincore.helpservice.service;

import com.fincore.helpservice.dto.HelpItemDTO;
import com.fincore.helpservice.dto.HelpRequestDTO;
import com.fincore.helpservice.dto.HelpResponseDTO;
import com.fincore.helpservice.model.HelpQuestionEntity;
import com.fincore.helpservice.repository.HelpFaqRepository;
import com.fincore.helpservice.repository.HelpQuestionRepository;
import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.springframework.cache.annotation.Cacheable;
import org.springframework.stereotype.Service;

import java.util.*;
import java.util.stream.Collectors;

@Service
@RequiredArgsConstructor
@Slf4j
public class HelpService {

    private final HelpQuestionRepository questionRepository;
    private final HelpFaqRepository faqRepository;

    // Words to ignore in search to improve relevance
    private static final Set<String> STOP_WORDS = Set.of("how", "to", "i", "can", "do", "a", "the", "in", "on", "what", "is");

    /**
     * MAIN PROCESSOR
     * ORCHESTRATOR: Decides whether to Fetch by Screen OR Perform Search
     */
    public HelpResponseDTO processRequest(HelpRequestDTO request) {

        // 1. Normalize Permissions / User Actions (Upper Case for safety)
        List<String> userActions = (request.getUserActions() == null)
                ? new ArrayList<>()
                : request.getUserActions().stream()
                .map(String::toUpperCase)
                .map(String::trim)
                .collect(Collectors.toList());

        List<HelpItemDTO> results = new ArrayList<>();
        String contextLabel = "";

        // 2. Determine Mode
        if (request.getSearchQuery() != null && request.getSearchQuery().length() > 2) {
            contextLabel = "Search Results";
            results = performSmartSearch(request.getSearchQuery(), userActions);
        }
        // 3. CONTEXT MODE (Select Module)
        else if (request.getScreenName() != null) {
            contextLabel = request.getScreenName();
            results = fetchContextualHelp(request.getScreenName(), userActions);
        }

        // 3. Append FAQs
        List<HelpItemDTO> faqs = null;
        if (request.isFetchFaqs()) {
            faqs = fetchGlobalFaqs();
        }

        return HelpResponseDTO.builder()
                .context(contextLabel)
                .results(results)
                .faqs(faqs)
                .build();
    }


    // =========================================================================
    // LOGIC 1: CONTEXTUAL FETCH
    // =========================================================================

    private List<HelpItemDTO> fetchContextualHelp(String screenName, List<String> userActions) {
        List<HelpQuestionEntity> rawQuestions = getQuestionsForScreen(screenName.trim());
        return rawQuestions.stream()
                .filter(q -> isActionAllowed(q, userActions))
                .map(q -> mapToDTO(q, "QUESTION"))
                .collect(Collectors.toList());
    }

    // =========================================================================
    // LOGIC 2: SMART FUZZY SEARCH
    // =========================================================================

    private List<HelpItemDTO> performSmartSearch(String query, List<String> userActions) {
        List<HelpQuestionEntity> allQuestions = getAllActiveQuestions();

        // Better Tokenization: e.g., "create cgl" -> ["create", "cgl"]
        List<String> tokens = Arrays.stream(query.toLowerCase().split("\\W+"))
                .filter(s -> !s.isEmpty() && !STOP_WORDS.contains(s))
                .collect(Collectors.toList());

        // Score, Filter & Sort
        return allQuestions.stream()
                .filter(q -> isActionAllowed(q, userActions))
                .map(q -> new AbstractMap.SimpleEntry<>(q, calculateScore(q, tokens)))
                .filter(entry -> entry.getValue() > 0)
                .sorted((e1, e2) -> Integer.compare(e2.getValue(), e1.getValue()))
                .limit(5) // Top 5
                .map(entry -> mapToDTO(entry.getKey(), "SEARCH_RESULT"))
                .collect(Collectors.toList());
    }

    // Custom Scoring Algorithm (No AI needed)
    private int calculateScore(HelpQuestionEntity q, List<String> tokens) {
        int score = 0;
        String text = q.getQuestionText().toLowerCase();
        String keywords = (q.getKeywords() != null) ? q.getKeywords().toLowerCase() : "";
        String action = (q.getRequiredAction() != null) ? q.getRequiredAction().toLowerCase() : "";

        for (String token : tokens) {
            if (token.equals(action)) score += 50; // Intent match
            if (text.contains(token)) score += 20; // Exact text match
            if (keywords.contains(token)) score += 15; // Hidden keyword match
            if (fuzzyMatch(token, text)) score += 5; // Typo match
        }
        return score;
    }

    // Levenshtein check (tolerance of 2 edits for words > 4 chars)
    private boolean fuzzyMatch(String token, String target) {
        if (target.contains(token)) return true;

        // Check against each word in target to avoid matching across word boundaries
        for(String word : target.split("\\W+")) {
            if (calculateDistance(token, word) <= 2 && token.length() > 3) return true;
        }
        return false;
    }


    // Standard Edit Distance Algo
    private int calculateDistance(String x, String y) {
        int[][] dp = new int[x.length() + 1][y.length() + 1];
        for (int i = 0; i <= x.length(); i++) {
            for (int j = 0; j <= y.length(); j++) {
                if (i == 0) dp[i][j] = j;
                else if (j == 0) dp[i][j] = i;
                else dp[i][j] = Math.min(dp[i - 1][j - 1] + (x.charAt(i - 1) == y.charAt(j - 1) ? 0 : 1),
                            Math.min(dp[i - 1][j] + 1, dp[i][j - 1] + 1));
            }
        }
        return dp[x.length()][y.length()];
    }

    // =========================================================================
    // CACHING & UTILS
    // =========================================================================

    @Cacheable(value = "help_questions", key = "#screenName")
    public List<HelpQuestionEntity> getQuestionsForScreen(String screenName) {
        return questionRepository.findByScreenNameAndIsActiveOrderByDisplayOrderAsc(screenName, "Y");
    }

    @Cacheable(value = "help_questions_all", key = "'active_global'")
    public List<HelpQuestionEntity> getAllActiveQuestions() {
        return questionRepository.findByIsActive("Y");
    }

    public List<HelpItemDTO> fetchGlobalFaqs() {
        return faqRepository.findByIsActiveOrderByDisplayOrderAsc("Y").stream()
                .map(f -> HelpItemDTO.builder().id(f.getFaqId()).text(f.getQuestionText()).answer(f.getAnswerContent()).type("FAQ").build())
                .collect(Collectors.toList());
    }

    private boolean isActionAllowed(HelpQuestionEntity q, List<String> userActions) {
        // If question has no restricted action, it's public for that screen
        if (q.getRequiredAction() == null || q.getRequiredAction().trim().isEmpty()) return true;

        // Super Admin Bypass
        if (userActions.contains("ALL") || userActions.contains("*")) return true;

        // Check List Inclusion
        return userActions.contains(q.getRequiredAction().toUpperCase());
    }

    private HelpItemDTO mapToDTO(HelpQuestionEntity q, String type) {
        return HelpItemDTO.builder()
                .id(q.getQuestionId())
                .text(q.getQuestionText())
                .answer(q.getAnswerContent())
                .actionLink(q.getActionLink())
                .actionLabel(q.getActionLabel())
                .type(type)
                .build();
    }
}

































package com.fincore.HelpService.controller;

import com.fincore.HelpService.dto.HelpDTOs.HelpRequestDTO;
import com.fincore.HelpService.dto.HelpDTOs.HelpResponseDTO;
import com.fincore.HelpService.service.HelpService;
import com.fincore.commonutilities.dto.ApiResponse; // Ensure this is imported
import jakarta.validation.Valid;
import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping("/api/v1/help")
@RequiredArgsConstructor
@Slf4j
public class HelpController {

    private final HelpService helpService;

    /**
     * Unified Help Endpoint.
     * Use ResponseEntity to bypass double-wrapping if ApiResponseWrapper is active.
     */
    @PostMapping("/fetch")
    public ResponseEntity<ApiResponse<HelpResponseDTO>> getHelp(@RequestBody @Valid HelpRequestDTO request) {
        
        long startTime = System.currentTimeMillis();
        try {
            HelpResponseDTO result = helpService.processRequest(request);
            
            log.info("Help processed in {}ms | Mode: {}", 
                     (System.currentTimeMillis() - startTime), 
                     (request.getSearchQuery() != null ? "Search" : "Context"));

            // Wrapping manually in ApiResponse
            ApiResponse<HelpResponseDTO> response = new ApiResponse<>(200, "Success", "Help content retrieved", result);
            return ResponseEntity.ok(response);

        } catch (Exception e) {
            log.error("Help Service Error", e);
            return ResponseEntity.internalServerError()
                    .body(new ApiResponse<>(500, "Error", "Internal Server Error: " + e.getMessage(), null));
        }
    }
}













package com.fincore.HelpService;

import com.fincore.commonutilities.config.RedisConfig;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cache.annotation.EnableCaching;
import org.springframework.context.annotation.Import;

@SpringBootApplication
@EnableCaching
@Import(RedisConfig.class) // Import the Redis configuration from Common Utils
public class HelpServiceApplication {
    public static void main(String[] args) {
        SpringApplication.run(HelpServiceApplication.class, args);
    }
}






-- =============================================================================
-- PROJECT: FIN CORE - HELP SERVICE
-- DBMS:    ORACLE SQL
-- DESC:    Schema definition for Contextual Help, FAQs, and Search Analytics.
-- =============================================================================

-- 1. CLEANUP (Optional - Use with caution in Dev)
-- DROP TABLE HELP_SEARCH_ANALYTICS CASCADE CONSTRAINTS;
-- DROP TABLE HELP_PERMISSION_MAPPING CASCADE CONSTRAINTS; -- (If we used mapping table, but we are using Action column strategy)
-- DROP TABLE HELP_QUESTION_MASTER CASCADE CONSTRAINTS;
-- DROP TABLE HELP_SCREEN_MASTER CASCADE CONSTRAINTS;
-- DROP TABLE HELP_FAQ_MASTER CASCADE CONSTRAINTS;

-- =============================================================================
-- TABLE 1: HELP_SCREEN_MASTER
-- DESC:    Registry of all Screens/Modules. 
--          MUST match 'MENU_TITLE' from the PERMISSIONS table.
-- =============================================================================
CREATE TABLE HELP_SCREEN_MASTER (
    SCREEN_NAME     VARCHAR2(100 CHAR) NOT NULL,
    SCREEN_LABEL    VARCHAR2(100 CHAR),
    IS_ACTIVE       CHAR(1 CHAR) DEFAULT 'Y' NOT NULL,
    CREATED_AT      TIMESTAMP DEFAULT SYSTIMESTAMP,
    UPDATED_AT      TIMESTAMP DEFAULT SYSTIMESTAMP,
    
    CONSTRAINT PK_HELP_SCREEN PRIMARY KEY (SCREEN_NAME),
    CONSTRAINT CHK_HSM_ACTIVE CHECK (IS_ACTIVE IN ('Y', 'N'))
);

COMMENT ON TABLE HELP_SCREEN_MASTER IS 'Registry of application screens. SCREEN_NAME must match Permissions Service MENU_TITLE.';
COMMENT ON COLUMN HELP_SCREEN_MASTER.SCREEN_LABEL IS 'Friendly display name for the Chat UI dropdown.';

-- =============================================================================
-- TABLE 2: HELP_QUESTION_MASTER
-- DESC:    The core content table containing questions, answers, and RBAC rules.
-- =============================================================================
CREATE TABLE HELP_QUESTION_MASTER (
    QUESTION_ID     VARCHAR2(50 CHAR) NOT NULL,
    SCREEN_NAME     VARCHAR2(100 CHAR) NOT NULL,
    QUESTION_TEXT   VARCHAR2(500 CHAR) NOT NULL,
    ANSWER_CONTENT  CLOB,
    
    -- Actionable Links
    ACTION_LINK     VARCHAR2(255 CHAR),
    ACTION_LABEL    VARCHAR2(50 CHAR),
    
    -- RBAC & Search
    REQUIRED_ACTION VARCHAR2(50 CHAR), -- e.g. 'CREATE', 'APPROVE'. NULL = Public for that screen.
    KEYWORDS        VARCHAR2(1000 CHAR), -- Comma separated synonyms for search (e.g. 'add, new, insert')
    
    -- Meta
    DISPLAY_ORDER   NUMBER(5,0) DEFAULT 0,
    IS_ACTIVE       CHAR(1 CHAR) DEFAULT 'Y' NOT NULL,
    CREATED_AT      TIMESTAMP DEFAULT SYSTIMESTAMP,
    UPDATED_AT      TIMESTAMP DEFAULT SYSTIMESTAMP,
    
    CONSTRAINT PK_HELP_QUESTION PRIMARY KEY (QUESTION_ID),
    CONSTRAINT FK_HQM_SCREEN FOREIGN KEY (SCREEN_NAME) REFERENCES HELP_SCREEN_MASTER(SCREEN_NAME),
    CONSTRAINT CHK_HQM_ACTIVE CHECK (IS_ACTIVE IN ('Y', 'N'))
);

-- Performance Index: Crucial for fetching all questions for a specific screen (The "Select Module" feature)
CREATE INDEX IDX_HQM_SCREEN ON HELP_QUESTION_MASTER(SCREEN_NAME);
-- Search Index: Useful if we decide to do DB-level searching later (though we plan In-Memory)
CREATE INDEX IDX_HQM_ACTION ON HELP_QUESTION_MASTER(REQUIRED_ACTION);

COMMENT ON TABLE HELP_QUESTION_MASTER IS 'Stores help questions. REQUIRED_ACTION maps to MENU_ACTION verbs.';
COMMENT ON COLUMN HELP_QUESTION_MASTER.KEYWORDS IS 'Synonyms used by the Java Fuzzy Search logic to improve relevance.';

-- =============================================================================
-- TABLE 3: HELP_FAQ_MASTER
-- DESC:    Global FAQs (Password reset, Support contacts) independent of Screens.
-- =============================================================================
CREATE TABLE HELP_FAQ_MASTER (
    FAQ_ID          VARCHAR2(50 CHAR) NOT NULL,
    QUESTION_TEXT   VARCHAR2(500 CHAR) NOT NULL,
    ANSWER_CONTENT  CLOB,
    DISPLAY_ORDER   NUMBER(5,0) DEFAULT 0,
    IS_ACTIVE       CHAR(1 CHAR) DEFAULT 'Y' NOT NULL,
    CREATED_AT      TIMESTAMP DEFAULT SYSTIMESTAMP,
    
    CONSTRAINT PK_HELP_FAQ PRIMARY KEY (FAQ_ID),
    CONSTRAINT CHK_HFM_ACTIVE CHECK (IS_ACTIVE IN ('Y', 'N'))
);

-- =============================================================================
-- TABLE 4: HELP_SEARCH_ANALYTICS
-- DESC:    Audit trail for what users are searching vs. clicking. 
--          Used to improve Keywords and Content.
-- =============================================================================
CREATE TABLE HELP_SEARCH_ANALYTICS (
    LOG_ID          VARCHAR2(50 CHAR) NOT NULL,
    USER_ID         VARCHAR2(50 CHAR), -- Optional, from Token
    SEARCH_QUERY    VARCHAR2(255 CHAR),
    SCREEN_CONTEXT  VARCHAR2(100 CHAR),
    CLICKED_Q_ID    VARCHAR2(50 CHAR), -- Null if user didn't click anything (Failed Search)
    SEARCH_TIMESTAMP TIMESTAMP DEFAULT SYSTIMESTAMP,
    
    CONSTRAINT PK_HELP_ANALYTICS PRIMARY KEY (LOG_ID)
);

COMMENT ON TABLE HELP_SEARCH_ANALYTICS IS 'Logs user search queries and clicks for optimization analysis.';

-- =============================================================================
-- DATA SEEDING (Based on your Permissions_Table.txt)
-- =============================================================================

-- 1. Populate Screens (Taken directly from your uploaded file's MENU_TITLE)
INSERT INTO HELP_SCREEN_MASTER (SCREEN_NAME, SCREEN_LABEL) VALUES ('Circle Management', 'Circle Management');
INSERT INTO HELP_SCREEN_MASTER (SCREEN_NAME, SCREEN_LABEL) VALUES ('CGL Management', 'CGL Management');
INSERT INTO HELP_SCREEN_MASTER (SCREEN_NAME, SCREEN_LABEL) VALUES ('Segment Management', 'Segment Management');
INSERT INTO HELP_SCREEN_MASTER (SCREEN_NAME, SCREEN_LABEL) VALUES ('Branch Management', 'Branch Management');
INSERT INTO HELP_SCREEN_MASTER (SCREEN_NAME, SCREEN_LABEL) VALUES ('User Management', 'User Management');

-- 2. Populate CGL Management Questions
-- Scenario A: General Info (No Action Required)
INSERT INTO HELP_QUESTION_MASTER (QUESTION_ID, SCREEN_NAME, QUESTION_TEXT, ANSWER_CONTENT, KEYWORDS, DISPLAY_ORDER) 
VALUES ('Q_CGL_001', 'CGL Management', 'What is a CGL Code?', 'CGL (Central General Ledger) codes are used for financial tracking...', 'definition, meaning, what is', 1);

-- Scenario B: Create Action (Requires 'CREATE' in payload)
INSERT INTO HELP_QUESTION_MASTER (QUESTION_ID, SCREEN_NAME, QUESTION_TEXT, ANSWER_CONTENT, ACTION_LINK, ACTION_LABEL, REQUIRED_ACTION, KEYWORDS, DISPLAY_ORDER) 
VALUES ('Q_CGL_002', 'CGL Management', 'How do I create a new CGL?', 'Click the "Add CGL" button in the top right corner.', '/cgl-management/create', 'Go to Create', 'CREATE', 'add, new, insert, make, generate', 2);

-- Scenario C: Approve Action (Requires 'APPROVE' in payload)
INSERT INTO HELP_QUESTION_MASTER (QUESTION_ID, SCREEN_NAME, QUESTION_TEXT, ANSWER_CONTENT, ACTION_LINK, ACTION_LABEL, REQUIRED_ACTION, KEYWORDS, DISPLAY_ORDER) 
VALUES ('Q_CGL_003', 'CGL Management', 'How to approve CGL requests?', 'Navigate to the "CGL Requests" tab and select "Approve" on the ballot.', '/cgl-requests', 'View Requests', 'APPROVE', 'authorize, sign off, check, accept', 3);

-- Scenario D: Modify Action
INSERT INTO HELP_QUESTION_MASTER (QUESTION_ID, SCREEN_NAME, QUESTION_TEXT, ANSWER_CONTENT, REQUIRED_ACTION, KEYWORDS, DISPLAY_ORDER) 
VALUES ('Q_CGL_004', 'CGL Management', 'How to edit a CGL description?', 'Select the CGL from the list and click the Pencil icon.', 'MODIFY', 'edit, update, change, correct', 4);

-- 3. Populate Segment Management Questions
INSERT INTO HELP_QUESTION_MASTER (QUESTION_ID, SCREEN_NAME, QUESTION_TEXT, ANSWER_CONTENT, REQUIRED_ACTION, KEYWORDS) 
VALUES ('Q_SEG_001', 'Segment Management', 'How to add a new Segment?', 'Use the Segment Master screen to add entries.', 'CREATE', 'add, new, create');

-- 4. Global FAQs
INSERT INTO HELP_FAQ_MASTER (FAQ_ID, QUESTION_TEXT, ANSWER_CONTENT, DISPLAY_ORDER) 
VALUES ('FAQ_001', 'I forgot my password', 'Please go to the login screen and click "Forgot Password".', 1);

INSERT INTO HELP_FAQ_MASTER (FAQ_ID, QUESTION_TEXT, ANSWER_CONTENT, DISPLAY_ORDER) 
VALUES ('FAQ_002', 'Who do I contact for support?', 'Email IT Support at helpdesk@fincore.com', 2);

COMMIT;



















permissions tabble:

MENU_ID	NUMBER(38,0)	No	"FINCORE"."MENU_ITEMS_SEQ"."NEXTVAL"	1	
MENU_TITLE	VARCHAR2(100 CHAR)	No		2	
MENU_ICON	VARCHAR2(100 CHAR)	Yes		3	
MENU_SUBMENU	VARCHAR2(100 CHAR)	Yes		4	
MENU_ACTION	VARCHAR2(200 CHAR)	No	NULL	5	
MENU_URL	VARCHAR2(200 CHAR)	No		6	
MENU_COMPONENT_PATH	VARCHAR2(200 CHAR)	No		7	
MENU_DESCRIPTION	VARCHAR2(255 BYTE)	No		8	
MENU_DEPENDANT	NUMBER(38,0)	Yes		9	
MAPPED_REQUEST_TYPE	VARCHAR2(50 CHAR)	Yes		10	
MENU_ORDER	VARCHAR2(255 CHAR)	Yes		11	
API_RESOURCE_PATTERN	VARCHAR2(255 CHAR)	Yes		12	"Defines the Backend REST API Endpoint pattern (e.g., /user/**, /cgl*) required to ACCESS data for this screen.
CRITICAL: This is used by the RBAC Filter to grant "Read/View" access.
If NULL, the screen may load blank."


data:
1	Circle Management	AccountTree	Manage Circles	view|create|modify|cancel	/circle-management	circle/CircleMaster	To manage circles and view status of self request		CIRCLE		/api/common-master/circle-codes/**,/api/common-master/zone-codes/**
2	Circle Management	Ballot	Circle Requests	view|approve|reject	/circle-requests	common/CommonRequestScreen	To review/approve pending requests for circles created by other user		CIRCLE		/api/common-master/circle-codes/**,/api/common-master/zone-codes/**
5	CGL Management	Casino	Manage CGL's	view|create|modify|cancel	/cgl-management	cgl/CGLMaster	To edit or update active CGLs and to view pending CGL requests		CGL_CODE		/api/common-master/cgl*
6	CGL Management	WorkspacePremium	CGL Requests	view|approve|reject	/cgl-requests	common/CommonRequestScreen	To efficiently review and process the pending requests for CGL master		CGL_CODE		/api/common-master/cgl*
7	Segment Management	Segment	Manage Segments	view|create|modify|cancel	/segment-management	segment/SegmentMaster	To manage segments in application		SEGMENT_CODE		/api/common-master/segment-codes
8	Segment Management	Grading	Segment Requests	view|approve|reject	/segment-requests	common/CommonRequestScreen	To efficiently review and process the pending requests for segment master		SEGMENT_CODE		/api/common-master/segment-codes
9	Branch Management	AccountBalance	Manage Branches	view|create|modify|cancel	/branch-management	branch/BranchMaster	To edit update branches and to check pending branch update requests		BRANCH		/api/common-master/branches*,/api/common-master/branches-check,/api/common-master/states,/api/common-master/circle-codes
10	Branch Management	AssuredWorkload	Branch Requests	view|approve|reject	/branch-requests	common/CommonRequestScreen	To efficiently review and process the pending requests for branch master		BRANCH		/api/common-master/branches*
12	User Management	People	Manage Users	view|create|modify|delete|cancel	/manage-user	user/pages/UserManagement	For creating new user		USER_MANAGEMENT		/api/user/**
13	User Management	WorkspacePremium	User Requests	view|approve|reject	/user-requests	user/pages/UserApprovals	To approve or reject user requests		USER_MANAGEMENT		/api/user/**
14	Calendar Configuration	EditCalendar	Calendar Configuration	view|create|modify|cancel	/calendar-configuration	calendarConfig/CalendarConfig	To manage financial calender configuration in application		CALENDER		/api/common-master/calendar-configuration,/api/common-master/calendar-config/**,/api/calendar-config/next-year-info/**
15	Calendar Configuration	EventAvailable	Calendar Config Requests	view|approve|reject	/calendar-config-requests	common/CommonRequestScreen	To efficiently review and process the pending requests for calender config master		CALENDER		/api/common-master/calendar-configuration
16	State Management	Domain	Manage States	view|create|modify|cancel	/state-management	state/StateMaster	To manage states in application		STATE		/api/common-master/states
17	State Management	DomainVerification	State Requests	view|approve|reject	/state-requests	common/CommonRequestScreen	To efficiently review and process the pending requests for state master		STATE		/api/common-master/states
18	Currency Management	LocalAtm	Manage Currencies	view|create|modify|cancel	/manage-currencies	currency/CurrencyMaster	To manage currency in application		CURRENCY		/api/common-master/currency*
19	Currency Management	CreditScore	Currency Requests	view|approve|reject	/currency-requests	common/CommonRequestScreen	To efficiently review and process the pending requests for currency master		CURRENCY		/api/common-master/currency*
20	Currency Rate Management	PriceChange	Currency Rate Change	view|modify|cancel	/manage-currency-rate	currency/CurrencyRateChange	To manage currency rate in application		CURRENCY_RATE_CHANGE		/api/common-master/currency-rate-change
21	Currency Rate Management	CurrencyRupee	Currency Rate Requests	view|approve|reject	/currency-rate-requests	common/CommonRequestScreen	To efficiently review and process the pending requests for currency rate master		CURRENCY_RATE_CHANGE		/api/common-master/currency-rate-change
22	Role Management	Badge	Manage Roles	view|create|modify|cancel	/manage-roles	role/RoleManagement	To manage roles in application		ROLE_MANAGEMENT		/api/role/**
23	Role Management	Elevator	Role Management Requests	view|approve|reject	/role-requests	role/RoleApprovals	To approve/reject role management related requests		ROLE_MANAGEMENT		/api/role/**
24	User Management	People	User Requests Audit	view	/user-audit	user/pages/UserLogs	Shows user audit requests		USER_MANAGEMENT		/api/user/**
25	Process Status	Memory		view	/process-status	process-status/ProcessStatusPage	This is demo description				/api/process/**
26	Reports	Summarize		view|download	/reports	glifReports/GlifReports	This is demo description				/api/reports/**
30	Journal Management	EditCalendar	Journal Posting	view|create	/journal-posting	journal/JournalPosting	This is demo description		JOURNAL_AUTH		/api/journals/**,/api/cgl-journal/**,/api/branches-journal/**,/api/common-master/currency,/api/**
31	Journal Management	Ballot	Journal Authorization	view|approve|reject	/journal-Authorization	journal/JournalAuthorization	This is demo description		JOURNAL_AUTH		/api/journals/**,/api/cgl-journal/**,/api/branches-journal/**
32	Journal Management	Ballot	Journal Posting Status	view|cancel	/journal-posting-status	journal/JournalPostingStatus	to cansel there own Request		JOURNAL_AUTH		/api/journals/**,/api/cgl-journal/**,/api/branches-journal/**
33	Balance Enquiry	AccountBalance		view	/balance-enquiry	balanceEnquiry/BalanceEnquiryScreen	This provides closing balance for each day according to selected range				/api/balance-enquiry/**
34	Transaction Enquiry	ReceiptLong		view	/transaction-enquiry	transaction-enquiry/TransactionEnquiry	This is demo description				/api/transactions*
35	Dashboard	GridView		view	/dashboard	dashboard/DashboardPage	Sample Dashboard screen MUI				/api/notifications/**,/api/dashboard/**
36	Journal Management	UploadFile	Journal Bulk Upload	view|upload	/journal-bulk-upload	journal/JournalBulkUpload	To Upload the Bulk Journals		JOURNAL_AUTH		/api/journals/**,/api/cgl-journal/**,/api/branches-journal/**
37	CGL Management	Visibility	View CGL Details	view	/view-cgl-details	cgl/CGLView	To View CGL details		CGL_CODE		/api/common-master/view-cgl*
38	Branch Management	Visibility	View Branch Details	view	/view-branch-details	branch/BranchView	To View Branch details				/api/common-master/view-branch*
39	Announcement Management	Campaign		view|create|modify|cancel	/announcements	announcements/Announcements	To manage announcements				/api/announcements/**
40	Test Process	Memory		view	/test-process-status	testprocess/ProcessStatusPage	This is demo description				
81	Report Management	ReceiptLong	Report Template Manager	view|create|modify|delete|cancel	/template-configuration	reportTemplateManager/pages/TemplateConfiguration	Configure, manage, and monitor your report templates				/api/template-config/**,/api/report-builder/**,/api/create-request/**
101	Report Management	ReceiptLong	Create Template	view|create|modify|delete|cancel	/report-builder	reportTemplateBuilder/ReportBuilder.page	Create dynamic report templates with report builder		RB_REPORT_TEMPLATE		/api/template-config/**
102	Report View	GridView		View	/report-view	viewReports/ReportView.page	view				/api/report-builder/**
103	Monitoring	GridView		view	/Monitoring	journal/Monitoring	demo text		Monitoring		
121	Report Management	DomainVerification	Template Requests	view|approve|reject	/template-requests	reportTemplate/TemplateRequestScreen	Efficiently review and process the pending requests for report templates		RB_REPORT_TEMPLATE		






role_permission :

ROLE_ID	NUMBER(10,0)	No		1	Foreign key to the ROLES table.
PERMISSION_ID	NUMBER(10,0)	No		2	Foreign key to the PERMISSIONS table.
PERMISSION_ORDER	NUMBER	Yes		3	Storing permission order against each role.

data :
192	24	8
192	21	7
192	20	6
192	15	5
192	17	4
192	16	3
192	10	2
192	9	1
190	17	3
190	15	4
190	10	2
190	9	1
154	9	1
154	10	2
153	9	1
153	15	5
153	17	4
153	16	3
153	10	2
151	19	5
151	9	2
151	10	1
151	15	3
151	18	4
149	16	2
149	17	3
149	10	1
147	21	5
147	9	1
147	16	3
147	10	2
147	17	4
130	9	1
130	15	3
130	16	2
60	26	9
60	25	10
60	37	1
60	2	2
60	39	3
60	7	4
60	103	5
60	102	6
60	34	8
60	33	7
58	17	4
58	10	2
58	16	3
58	9	1
56	81	2
56	26	1
56	101	4
56	102	3
54	38	12
54	25	11
54	24	10
54	21	9
54	20	8
54	19	7
54	18	6
54	15	5
54	17	4
54	10	2
54	9	1
54	16	3




roles :
ROLE_ID	NUMBER(10,0)	No	NULL 	1	 Unique identifier for the role
ROLE_NAME	VARCHAR2(255 CHAR)	No		2	 Name of the role
DESCRIPTION	VARCHAR2(255 CHAR)	Yes		3	 Description of the role
ROLE_STATUS	VARCHAR2(255 CHAR)	No	"'ACTIVE'
   "	4	Status of the role ( Active/Blocked)

data :
51	UCO	users will be responsible for managing users in fincore system	ACTIVE
52	PSO 	Will be monitoring the applications day to day activities, start or kill any job activity makerchecker can be added for critical activities	ACTIVE
53	FRT 	for whole bank	ACTIVE
54	Branch 	existing branch users rights	ACTIVE
55	Support 	for providing technical support for the application	ACTIVE
56	GLIF 	GLIF and IMPL teams of TCS manage their work in fincore application.	ACTIVE
148	SASANK	Testing	ACTIVE
58	External users	for providing access to other application through API's etc	ACTIVE
150	Dummy	Dummy	ACTIVE
152	JKA	Dummy	ACTIVE
157	FRT	rtrff	ACTIVE
192	Testing new role	testing purpose	ACTIVE
130	STA	TESTING FOR DROPDOWN	ACTIVE
153	OFFICE	Dummy	ACTIVE
60	Developer	For Developer access to build fincore application	ACTIVE
11	F1/BOG 	Finance One and BOG User	ACTIVE
191	Testing	bghbbdzszcb	ACTIVE
10	ADMIN	Administartor access to fincore application	ACTIVE
146	Niharika	Testing role	ACTIVE
